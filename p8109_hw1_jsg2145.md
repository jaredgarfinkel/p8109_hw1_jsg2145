p8109\_hw1\_jsg2145
================
Jared Garfinkel
2/4/2020

``` r
pchisq(6, 6)
```

    ## [1] 0.5768099

``` r
dloglikgamma = function(x, a) {return(-log(mean(x)) + log(a) - digamma(a) + mean(log(x)))}
```

``` r
x = rgamma(20, shape=5, scale = 2)
dloglikgamma(x, 0.1)
```

    ## [1] 8.019392

``` r
dloglikgamma(x, 100)
```

    ## [1] -0.09676903

``` r
a= 0.1
b=100
tol = exp(-10)
i = 0
cur = (a+b)/2
res = c(i, cur, dloglikgamma(x, cur))
while (abs(dloglikgamma(x, cur)) > tol) {
  i <- i + 1
  if (dloglikgamma(x, a) * dloglikgamma(x, cur) > 0)
    a <- cur
  else
    b <- cur
  cur <- (a + b) / 2
  res <- rbind(res, c(i, cur, dloglikgamma(x, cur)))
}
```

``` r
alphahat = res[nrow(res), 2]
betahat = mean(x) / alphahat
res
```

    ##     [,1]      [,2]          [,3]
    ## res    0 50.050000 -9.175409e-02
    ##        1 25.075000 -8.170467e-02
    ##        2 12.587500 -6.152980e-02
    ##        3  6.343750 -2.089397e-02
    ##        4  3.221875  6.136557e-02
    ##        5  4.782813  6.390969e-03
    ##        6  5.563281 -9.218409e-03
    ##        7  5.173047 -2.019911e-03
    ##        8  4.977930  2.015636e-03
    ##        9  5.075488 -4.209153e-05

``` r
d2loglikgamma <- function(x, a) {
  return(1/a - trigamma(a))
}
```

``` r
cur <- start <- 1
resnewton <- c(i, cur, dloglikgamma(x, cur))
while (abs(dloglikgamma(x, cur)) > tol) {
  i <- i + 1
  cur <- cur - dloglikgamma(x, cur) / d2loglikgamma(x, cur)
  resnewton <- rbind(resnewton, c(i, cur, dloglikgamma(x, cur)))
}

alphahat <- resnewton[nrow(resnewton), 2]
betahat <- mean(x)/alphahat
resnewton
```

    ##           [,1]     [,2]         [,3]
    ## resnewton    9 1.000000 4.754383e-01
    ##             10 1.737189 2.128538e-01
    ##             11 2.824709 8.555217e-02
    ##             12 4.048835 2.676823e-02
    ##             13 4.860428 4.607125e-03
    ##             14 5.064240 1.909944e-04
    ##             15 5.073436 3.566285e-07
